// Ion.ImageSlider
// version 1.2.70
// http://ionden.com/a/plugins/ion.imageSlider/
(function(d){d.fn.ionImageSlider=function(E){function A(b,a,B,d){var e=b.width();50<d&&(e=100);if(30<e)a.onLoadImage(b,B);else setTimeout(function(){A(b,a,B,d+1)},100)}var h=d.extend({zoomText:"Zoom",startFrom:0,slideShow:!0,slideShowDelay:7},E),g=this,p=null,u=null,v=null,w=null,q=null,j=null,x=null,f=[],l=0,C=0,k=0,e=h.startFrom,s=0,t=!1,m=!1,n=0,y=null,c='<div class="ion-image-slider-content">',c=c+'<div class="ion-image-slider-scroll"></div>',c=c+'<div class="ion-image-slider-preloader"></div>',
c=c+'<div class="ion-image-slider-shadow-left"></div>',c=c+'<div class="ion-image-slider-shadow-right"></div>',c=c+"</div>",c=c+'<div class="ion-image-slider-bullets"></div>',z='<div class="ion-image-slider-arr-prev"></div>',z=z+'<div class="ion-image-slider-arr-next"></div>',r={init:function(){var b=this;g.append(c);p=g.find("a");u=p.children("img");q=g.find("div.ion-image-slider-content");v=g.find("div.ion-image-slider-bullets");k=u.length;C=q.outerWidth();this.loadCounter=0;u.each(function(a){A(d(this),
b,a,0)})},onLoadImage:function(b,a){this.loadCounter++;f[a]={width:b.width(),height:b.height(),caption:b.data("caption")||"",url:b.parent("a").prop("href")};v.append('<span class="ion-image-slider-bullet"></span>');this.loadCounter===k&&this.buildSlider()},buildSlider:function(){g.find("div.ion-image-slider-preloader").remove();q.append(z);p.each(function(a){var b=f[a].width+22,e=f[a].height+22;d(this).width(b).height(e).addClass("ssi-"+a);b='<span class="ion-image-slider-zoom"></span>'+('<span class="ion-image-slider-zoom-text">'+
h.zoomText+"</span>");f[a].caption&&(b+='<span class="ion-image-slider-caption" style="max-width: '+(parseInt(f[a].width)-10)+'px;">'+f[a].caption+"</span>");d(this).append(b)});for(var b=0;b<k;b++)l+=f[b].width+42;q.find("div.ion-image-slider-scroll").html('<div class="ion-image-slider-pad" id="ion-image-slider-pad"></div>');j=d("#ion-image-slider-pad");j.width(3*l);p.appendTo(j);p.clone().appendTo(j);p.clone().appendTo(j);x=j.find("a");w=v.find("span.ion-image-slider-bullet");w.each(function(a){d(this).prop("id",
"ion-image-slider-bullet-"+a).data("num",a)});this.buildEvents();this.moveToPos(!0)},buildEvents:function(){var b=this;g.find("div.ion-image-slider-arr-prev").on("click",function(){t||(e--,b.moveToPos())});g.find("div.ion-image-slider-arr-next").on("click",function(){t||(e++,b.moveToPos())});w.on("click",function(){t||(e=d(this).data("num"),b.moveToPos())});h.slideShow&&this.slideShow();q.on("mouseenter",function(){h.slideShow&&(clearInterval(y),n=0)});q.on("mouseleave",function(){h.slideShow&&!m&&
b.slideShow()});x.on("click",function(a){a.preventDefault();a=parseInt(d(this).prop("class").slice(4));m=!0;D.open(a,f)})},slideShow:function(){var b=this;y=setInterval(function(){n+=10;n>=100*h.slideShowDelay&&(n=0,e++,b.moveToPos())},100)},setActiveBullet:function(){d("#ion-image-slider-bullet-"+e).addClass("active").siblings().removeClass("active")},moveToPos:function(b){b||(t=!0);0>e?e=k-1:e>k-1&&(e=0);this.setActiveBullet();h.slideShow&&(n=0);for(var a=0,d=Math.round(C/2),c=0;c<e;c++)a+=f[c].width+
42;for(var a=Math.round(d-a-(f[e].width+42)/2+10),a=Math.round(a-l),g=c=0;g<s;g++)c+=f[g].width+42;c=Math.round(d-c-(f[s].width+42)/2+10);c=Math.round(c-l);e===k-1&&0===s&&(c=d-(f[0].width+42)/2-2*l+10);0===e&&s===k-1&&(c=d+(f[k-1].width+42)/2-l+10);this.setActive();j.css("left",c+"px");b?j.css("left",a+"px"):j.stop().animate({left:a},300,function(){t=!1});s=e},setActive:function(){x.eq(k+e).addClass("active").siblings().removeClass("active")}},D={init:function(){var b=this;this.body=d(document.body);
var a;a='<div class="ion-image-slider-overlay"></div><div class="ion-image-slider-popup"><div class="ion-image-slider-popup-prev"><div></div></div>';a+='<div class="ion-image-slider-popup-next"><div></div></div>';a+='<div class="ion-image-slider-popup-close">&times;</div>';a+='<div class="ion-image-slider-popup-caption"></div>';a+="</div>";this.body.append(a);this.overlay=d("div.ion-image-slider-overlay");this.popup=d("div.ion-image-slider-popup");this.prev=d("div.ion-image-slider-popup-prev");this.next=
d("div.ion-image-slider-popup-next");this.caption=d("div.ion-image-slider-popup-caption");this.image=null;this.height=this.width=0;this.overlay.on("click",function(){b.close()});this.popup.on("click",function(){b.close()});this.prev.on("click",function(a){a.stopPropagation();e--;r.moveToPos();b.change(-1)});this.next.on("click",function(a){a.stopPropagation();e++;r.moveToPos();b.change(1)});this.body.on("keydown",function(a){27==a.which&&m&&b.close();37==a.which&&m&&(e--,r.moveToPos(),b.change(-1));
39==a.which&&m&&(e++,r.moveToPos(),b.change(1))})},change:function(b){this.close();var a=this.current,a=a+b;0>a?a=this.info.length-1:a>this.info.length-1&&(a=0);this.open(a,this.info)},open:function(b,a){this.current=b;this.info=a;this.info[b].caption?this.caption.css("display","block").text(this.info[b].caption):this.caption.css("display","none");h.slideShow&&(clearInterval(y),n=0);this.overlay.css("display","block");this.loadImage()},loadImage:function(){var b=this;this.body.append('<img src="'+
this.info[this.current].url+'" class="ion-image-slider-big" />');this.image=d("img.ion-image-slider-big");this.image.on("load",function(){b.width=d(this).width();b.height=d(this).height();b.placeImage()})},placeImage:function(){this.popup.addClass("opend");this.popup.prepend(this.image);var b=d(window).innerWidth()-40,a=d(window).innerHeight()-40,c=this.height/this.width;this.width>b&&(this.width=b,this.height=this.width*c);this.height>a&&(this.height=a,this.width=this.height/c);this.popup.width(this.width+
"px");this.popup.height(this.height+"px");this.popup.css("marginTop",-(this.height/2)+"px");this.popup.css("marginLeft",-(this.width/2)+"px");m=!0},close:function(){this.overlay.css("display","none");this.image.remove();this.popup.removeClass("opend");m=!1;h.slideShow&&r.slideShow()}};r.init();D.init()}})(jQuery);